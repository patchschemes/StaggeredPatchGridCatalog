function idiv(n,b){return Math.trunc(n/b)}function prod(a){return a.reduce((p,el)=>p*el)}function size(a){var N=a[0].length;if(N==undefined){N=1}return[a.length,N]}function linspacen(start,stop,num){const step=(stop-start)/(num-1);return Array.from({length:num},(_,i)=>start+step*i)}function linspaces(start,stop,step=1){const num=Math.floor(1+(stop-start)/step);return Array.from({length:num},(_,i)=>start+step*i)}function rev(a){return[...a].reverse()}function col(A,j){var M=A.length;var N=A[0].length;if(j==-1){j=N-1}var c=[];for(let i=0;i<M;i++){c.push([A[i][j]])}return c}function repeatv(a,n){var b=[];for(let i=0;i<n;i++){b.push(a[0])}return b}function repeath(a,n){var b=[];for(let i=0;i<a.length;i++){b.push(Array(n).fill(a[i][0]))}return b}function reshape(a,M,N){var a=a.flat();var n=a.length;if(M==null&&N==null){throw"[reshape] incorrect size"}if(N==null){N=n/M;if(!Number.isInteger(N)){throw"[reshape] incorrect size"}}else if(M==null){M=n/N;if(!Number.isInteger(M)){throw"[reshape] incorrect size"}}var A=[];var k=-1;for(let i=0;i<M;i++){let row=[];for(let j=0;j<N;j++){k+=1;row.push(a[k])}A.push(row)}return A}function bcast(opStr,A,B){if(opStr=="+"){var op=(x,y)=>x+y}else if(opStr=="-"){var op=(x,y)=>x-y}else if(opStr=="*"){var op=(x,y)=>x*y}else if(opStr=="/"){var op=(x,y)=>x/y}var m1=A.length;var n1=A[0].length;if(n1==undefined){A=reshape(A,null,1);n1=1}var m2=B.length;var n2=B[0].length;if(n2==undefined){B=reshape(B,null,1);n2=1}var s1=Math.max(m1,n1);var s2=Math.max(m2,n2);var a=A.flat();var b=B.flat();var C=[];if(m1==1&&n1>=1&&n2==1){for(let i=0;i<s2;i++){elB=b[i];C.push([]);for(let j=0;j<s1;j++){elA=a[j];C[i][j]=op(elA,elB)}}}else if(m1>=1&&n1==1&&m2==1){for(let i=0;i<s1;i++){elA=a[i];C.push([]);for(let j=0;j<s2;j++){elB=b[j];C[i][j]=op(elA,elB)}}}return C}function meshgrid(x,y){var M=x.length;var N=y.length;var xx=[];var yy=[];for(let i=0;i<M;i++){xx.push([]);yy.push([]);for(let j=0;j<N;j++){xx[i][j]=x[i];yy[i][j]=y[j]}}return[xx,yy]}function zeros([M,N]){if(N==undefined){N=1}return Array(M).fill([]).map(x=>Array(N).fill(0))}function fill(val,[M,N]){if(N==undefined){N=1}return Array(M).fill([]).map(x=>Array(N).fill(val))}function findClosest(A,val,ula="A"){if(ula=="A"){errfn=(a,v)=>Math.abs(a-v)}else if(ula=="U"){errfn=(a,v)=>a>=v?a-v:1e12}else if(ula=="L"){errfn=(a,v)=>a<=v?v-a:1e12}var k=undefined;var err=1e10;for(let i=0;i<A.length;i++){let errNew=errfn(A[i],val);if(errNew<err){k=i;err=errNew}}return k}muGridTypes_feasible=["hhhh","hhhv","hhvh","hhvv","huhh","huhv","huvh","huvv","uhhh","uhhv","uhvh","uhvv","uuhh","uuhv","uuvh","uuvv"];centredPGridTypes_evenn2=[370,514,1186,1378,3778,3826,4994,5138,5283,5427,6082,6099,6150,6290,6291,6294,6303,8674,8691,8738,8739,8742,8751,8895,19682,19874,19954,19971,20022,20162,20163,20166,20175,20838,21030,23410,23426,23427,23430,23439,23478,23631,63890,63938,64162,64179,64226,64227,64230,64239,64383,65026,65042,65043,65046,65055,65094,65247,67647,67695];centredPGridTypes_oddn2=[1393,1441,3841,4033,4705,4849,19889,19937,21045,21093,23425,23493,23646,23681,23685,23694,23697,24289,24357,24497,24501,24510,24513,24561,63953,64145,65041,65109,65262,65297,65301,65310,65313,67710,67902,68497,68561,68565,68574,68577,68718,68769,78689,78833,79777,79845,79985,79989,79998,80001,80049,82369,82433,82437,82446,82449,82590,82641,83313,83457];function numberToBase(n,b){if(n==0){return[0]}var digits=[];while(n>0){digits.push(n%b);n=idiv(n,b)}return digits.reverse()}function idToPGridType(idNum){var inds=numberToBase(idNum,17);var nInds=inds.length;if(nInds>4){throw"idNum $idNum is invalid! corresponding to $nInds patches in a cell."}else if(nInds<4){var indsFull=[];for(let i=0;i<4-nInds;i++){indsFull.push(0)}inds=indsFull.concat(inds)}var muGridTypes=[];for(let i=0;i<inds.length;i++){d=inds[i];if(d==0){muGridTypes.push("xxxx")}else{muGridTypes.push(muGridTypes_feasible[d-1])}}return muGridTypes.join("+")}function pGridTypeToId(pGridType){if(pGridType.length!=19){return-1}if(pGridType=="xxxx+xxxx+xxxx+xxxx"){return-1}var muGridTypes=pGridType.split("+");var pTs="huvx";isValidi=muGridTypes.map(p=>p.length==4&&pTs.includes(p[0])&&pTs.includes(p[1])&&pTs.includes(p[2])&&pTs.includes(p[2]));var isValid=isValidi[0]&&isValidi[1]&&isValidi[2]&&isValidi[3];if(!isValid){return-1}var nD=muGridTypes.length;var idNum=0;var d=0;for(let iD=0;iD<nD;iD++){let edgeType=muGridTypes[iD];if(edgeType!="xxxx"&&!muGridTypes_feasible.includes(edgeType)){return-1}if(edgeType=="xxxx"){d=0}else{d=muGridTypes_feasible.indexOf(edgeType)+1}idNum+=d*Math.pow(17,nD-(iD+1))}return idNum}function getPatchEdgeThicks(modelName){if(modelName.startsWith("idlWve")){edgeThickN=1;edgeThickT=0}else if(modelName.startsWith("sNlrWtr")||modelName.startsWith("gLnrWve")){edgeThickN=2;edgeThickT=0}else if(modelName.startsWith("vSwtrS")){edgeThickN=2;edgeThickT=1}else if(modelName.startsWith("vSwtrC")){edgeThickN=3;edgeThickT=2}else if(modelName.startsWith("tSwtrSmgrS")){edgeThickN=2;edgeThickT=1}else if(modelName.startsWith("tSwtrSmgrC")){edgeThickN=2;edgeThickT=2}return[edgeThickN,edgeThickT]}function gridSpacing(spacing,N,xMin,xMax){if(spacing=="lr"){return linspacen(xMin,xMax,N+1)}else if(spacing=="lr-old"){L=xMax-xMin;Dx=L/N;return linspacen(xMin+Dx/2,xMax-Dx/2,N)}else if(spacing=="hc"){L=xMax-xMin;t=linspacen(0,Math.PI,N+1);xb=[];for(let i=0;i<N+1;i++){beta=(1-Math.cos(t[i]))/2;xb.push(xMin+beta*L)}return xb}else if(spacing=="hc-old"){L=xMax-xMin;t=linspacen(0,Math.PI,N+1);xb=[];for(let i=0;i<N;i++){beta=(1-Math.cos(t[i]))/2;xb.push(xMin+beta*L)}return xb}}const iEtypeL=0;const iEtypeR=1;const iEtypeB=2;const iEtypeT=3;function genMicroGrid_ij(microGridType,nx,ny,noBoundary=true){edgeType=microGridType;if(["uh","hu"].includes(edgeType[iEtypeL]+edgeType[iEtypeR])){nx-=1}if(["vh","hv"].includes(edgeType[iEtypeB]+edgeType[iEtypeT])){ny-=1}if(edgeType[iEtypeL]=="h"){if(noBoundary){ihS=2;iuS=1;ivS=2}else{ihS=0;iuS=1;ivS=2}}else if(edgeType[iEtypeL]=="u"){if(noBoundary){ihS=1;iuS=2;ivS=1}else{ihS=1;iuS=0;ivS=1}}else if(edgeType[iEtypeL]=="v"){if(noBoundary){ihS=2;iuS=1;ivS=2}else{ihS=2;iuS=1;ivS=0}}if(edgeType[iEtypeR]=="h"){if(noBoundary){ihE=nx-2;iuE=nx-1;ivE=nx-1}else{ihE=nx;iuE=nx-1;ivE=nx-1}}else if(edgeType[iEtypeR]=="u"){if(noBoundary){ihE=nx;iuE=nx-1;ivE=nx}else{ihE=nx;iuE=nx+1;ivE=nx}}else if(edgeType[iEtypeR]=="v"){if(noBoundary){ihE=nx-1;iuE=nx;ivE=nx-1}else{ihE=nx-1;iuE=nx;ivE=nx+1}}if(edgeType[iEtypeB]=="h"){if(noBoundary){jhS=2;juS=2;jvS=1}else{jhS=0;juS=2;jvS=1}}else if(edgeType[iEtypeB]=="u"){if(noBoundary){jhS=2;juS=2;jvS=1}else{jhS=2;juS=0;jvS=1}}else if(edgeType[iEtypeB]=="v"){if(noBoundary){jhS=1;juS=1;jvS=2}else{jhS=1;juS=1;jvS=0}}if(edgeType[iEtypeT]=="h"){if(noBoundary){jhE=ny-2;juE=ny-1;jvE=ny-1}else{jhE=ny;juE=ny-1;jvE=ny-1}}else if(edgeType[iEtypeT]=="u"){if(noBoundary){jhE=ny-1;juE=ny-2;jvE=ny}else{jhE=ny-1;juE=ny;jvE=ny}}else if(edgeType[iEtypeT]=="v"){if(noBoundary){jhE=ny-1;juE=ny;jvE=ny-2}else{jhE=ny-1;juE=ny;jvE=ny}}try{ih=linspaces(ihS,ihE,2);iu=linspaces(iuS,iuE,2);iv=linspaces(ivS,ivE,2);jh=linspaces(jhS,jhE,2);ju=linspaces(juS,juE,2);jv=linspaces(jvS,jvE,2)}catch(exc){throw'ERR! genMicroGrid_ij: edgeType "'+edgeType+'" is not implemented yet'}return[nx,ny,ih,jh,iu,ju,iv,jv]}function genStagPatch2D(cfg,xb,yb,microGridType){var p={};var edgeType=microGridType;if(!(muGridTypes_feasible.includes(edgeType)||edgeType=="xxxx")){throw'genStagPatch2D/ incorrect edgeType "'+edgeType+'" in pGridType "'+cfg.pGridType+'"'}p.edgeType=edgeType;p.Dx=xb[1]-xb[0];p.Dy=yb[1]-yb[0];p.xc=(xb[0]+xb[1])/2;p.yc=(yb[0]+yb[1])/2;var rx=cfg["rx"];var ry=cfg["ry"];if(cfg["patchAR"]=="sq"&&p.Dx!=p.Dy){if(p.Dx>p.Dy){rx=cfg["ry"]*p.Dy/p.Dx}else{ry=cfg["rx"]*p.Dx/p.Dy}}p.rx=rx;p.ry=ry;p.lx=2*rx*p.Dx;p.ly=2*ry*p.Dy;if(edgeType=="xxxx"){p.centerField="x";p.centerInd=[-1,-1];p.nI=0;return p}[nx,ny,ih,jh,iu,ju,iv,jv]=genMicroGrid_ij(microGridType,cfg["nx"],cfg["ny"]);var delx=p.lx/nx;var dely=p.ly/ny;p.nx=nx;p.ny=ny;p.ih=ih;p.jh=jh;p.iu=iu;p.ju=ju;p.iv=iv;p.jv=jv;p.delx=delx;p.dely=dely;var twodelx=2*delx;twodely=2*dely;var xOff=p.xc-p.lx/2;var yOff=p.yc-p.ly/2;var xg=linspaces(xOff,xOff+nx*delx,delx);var yg=linspaces(yOff,yOff+ny*dely,dely);[p.xxg,p.yyg]=meshgrid(xg,yg);var xh=ih.map(el=>el*delx+xOff);var yh=jh.map(el=>el*dely+yOff);[p.xxh,p.yyh]=meshgrid(xh,yh);var xu=iu.map(el=>el*delx+xOff);var yu=ju.map(el=>el*dely+yOff);[p.xxu,p.yyu]=meshgrid(xu,yu);var xv=iv.map(el=>el*delx+xOff);var yv=jv.map(el=>el*dely+yOff);[p.xxv,p.yyv]=meshgrid(xv,yv);p.sh=size(p.xxh);p.su=size(p.xxu);p.sv=size(p.xxv);p.h=zeros(p.sh);p.u=zeros(p.su);p.v=zeros(p.sv);p.dhdt=zeros(p.sh);p.dudt=zeros(p.su);p.dvdt=zeros(p.sv);p.ihS=0;p.ihE=p.sh[0]-1;p.iuS=0;p.iuE=p.su[0]-1;p.ivS=0;p.ivE=p.sv[0]-1;p.jhS=0;p.jhE=p.sh[1]-1;p.juS=0;p.juE=p.su[1]-1;p.jvS=0;p.jvE=p.sv[1]-1;if(edgeType[iEtypeL]=="u"){var nTE_uBT=Math.ceil(cfg["edgeThickT"]/2);var nTE_vBT=cfg["edgeThickT"]-nTE_uBT;var nTE_hBT=nTE_vBT;var nNE_uL=Math.ceil(cfg["edgeThickN"]/2);var nNE_hL=nNE_vL=cfg["edgeThickN"]-nNE_uL}else{var nTE_hBT=Math.ceil(cfg["edgeThickT"]/2);var nTE_vBT=nTE_hBT;var nTE_uBT=cfg["edgeThickT"]-nTE_hBT;var nNE_hL=Math.ceil(cfg["edgeThickN"]/2);var nNE_vL=cfg["edgeThickN"]-nNE_hL;var nNE_uL=cfg["edgeThickN"]-nNE_hL}if(edgeType[iEtypeR]=="u"){var nTE_uBT=Math.ceil(cfg["edgeThickT"]/2);var nTE_vBT=cfg["edgeThickT"]-nTE_uBT;var nTE_hBT=nTE_vBT;var nNE_uR=Math.ceil(cfg["edgeThickN"]/2);var nNE_hR=cfg["edgeThickN"]-nNE_uR;var nNE_vR=cfg["edgeThickN"]-nNE_uR}else{var nTE_hBT=Math.ceil(cfg["edgeThickT"]/2);var nTE_vBT=nTE_hBT;var nTE_uBT=cfg["edgeThickT"]-nTE_hBT;var nNE_hR=Math.ceil(cfg["edgeThickN"]/2);var nNE_vR=cfg["edgeThickN"]-nNE_hR;var nNE_uR=cfg["edgeThickN"]-nNE_hR}if(edgeType[iEtypeB]=="v"){var nTE_vLR=Math.ceil(cfg["edgeThickT"]/2);var nTE_hLR=cfg["edgeThickT"]-nTE_vLR;var nTE_uLR=nTE_hLR;var nNE_vB=Math.ceil(cfg["edgeThickN"]/2);var nNE_hB=nNE_uB=cfg["edgeThickN"]-nNE_vB}else{var nTE_hLR=Math.ceil(cfg["edgeThickT"]/2);var nTE_vLR=cfg["edgeThickT"]-nTE_hLR;var nTE_uLR=nTE_hLR;var nNE_hB=Math.ceil(cfg["edgeThickN"]/2);var nNE_uB=cfg["edgeThickN"]-nNE_hB;var nNE_vB=cfg["edgeThickN"]-nNE_hB}if(edgeType[iEtypeT]=="v"){var nTE_vLR=Math.ceil(cfg["edgeThickT"]/2);var nTE_hLR=cfg["edgeThickT"]-nTE_vLR;var nTE_uLR=nTE_hLR;var nNE_vT=Math.ceil(cfg["edgeThickN"]/2);var nNE_hT=nNE_uT=cfg["edgeThickN"]-nNE_vT}else{var nTE_hLR=Math.ceil(cfg["edgeThickT"]/2);var nTE_vLR=cfg["edgeThickT"]-nTE_hLR;var nTE_uLR=nTE_hLR;var nNE_hT=Math.ceil(cfg["edgeThickN"]/2);var nNE_uT=cfg["edgeThickN"]-nNE_hT;var nNE_vT=cfg["edgeThickN"]-nNE_hT}var xhL=p.xxh[0];var xuL=p.xxu[0];var xvL=p.xxv[0];var yhL=p.yyh[0];var yuL=p.yyu[0];var yvL=p.yyv[0];var xhR=p.xxh[p.xxh.length-1];var xuR=p.xxu[p.xxu.length-1];var xvR=p.xxv[p.xxv.length-1];var yhR=p.yyh[p.yyh.length-1];var yuR=p.yyu[p.yyu.length-1];var yvR=p.yyv[p.yyv.length-1];xhL=reshape(xhL,1,null);xuL=reshape(xuL,1,null);xvL=reshape(xvL,1,null);yhL=reshape(yhL,1,null);yuL=reshape(yuL,1,null);yvL=reshape(yvL,1,null);xhR=reshape(xhR,1,null);xuR=reshape(xuR,1,null);xvR=reshape(xvR,1,null);yhR=reshape(yhR,1,null);yuR=reshape(yuR,1,null);yvR=reshape(yvR,1,null);if(nTE_hLR>0){p.jhS=nTE_hLR+1;jAdd=linspaces(1,nTE_hLR);xhL[0].splice(0,0,xhL[0][0]);xhL[0].push(xhL[0][xhL[0].length-1]);yhL=[rev(jAdd).map(el=>yhL[0][0]-el*twodely).concat(yhL[0],jAdd.map(el=>yhL[0][yhL[0].length-1]+el*twodely))];xhR[0].splice(0,0,xhR[0][0]);xhR[0].push(xhR[0][xhR[0].length-1]);yhR=[rev(jAdd).map(el=>yhR[0][0]-el*twodely).concat(yhR[0],jAdd.map(el=>yhR[0][yhR[0].length-1]+el*twodely))];p.jhE=yhR[0].length-nTE_hLR}if(nTE_uLR>0){p.juS=nTE_uLR+1;jAdd=linspaces(1,nTE_uLR);xuL[0].splice(0,0,xuL[0][0]);xuL[0].push(xuL[0][xuL[0].length-1]);yuL=[rev(jAdd).map(el=>yuL[0][0]-el*twodely).concat(yuL[0],jAdd.map(el=>yuL[0][yuL[0].length-1]+el*twodely))];xuR[0].splice(0,0,xuR[0][0]);xuR[0].push(xuR[0][xuR[0].length-1]);yuR=[rev(jAdd).map(el=>yuR[0][0]-el*twodely).concat(yuR[0],jAdd.map(el=>yuR[0][yuR[0].length-1]+el*twodely))];p.juE=yuR[0].length-nTE_uLR}if(nTE_vLR>0){p.jvS=nTE_vLR+1;jAdd=linspaces(1,nTE_vLR);xvL[0].splice(0,0,xvL[0][0]);xvL[0].push(xvL[0][xvL[0].length-1]);yvL=[rev(jAdd).map(el=>yvL[0][0]-el*twodely).concat(yvL[0],jAdd.map(el=>yvL[0][yvL[0].length-1]+el*twodely))];xvR[0].splice(0,0,xvR[0][0]);xvR[0].push(xvR[0][xvR[0].length-1]);yvR=[rev(jAdd).map(el=>yvR[0][0]-el*twodely).concat(yvR[0],jAdd.map(el=>yvR[0][yvR[0].length-1]+el*twodely))];p.jvE=yvR[0].length-nTE_vLR}if(nNE_hL>0){p.xhEl=bcast("-",xhL,rev(linspaces(1,nNE_hL)).map(el=>el*twodelx));p.yhEl=repeatv(yhL,p.xhEl.length);p.hEl=zeros([p.xhEl.length,p.xhEl[0].length])}else{p.xhEl=p.yhEl=p.hEl=[[]]}if(nNE_hR>0){p.xhEr=bcast("+",xhR,linspaces(1,nNE_hR).map(el=>el*twodelx));p.yhEr=repeatv(yhR,p.xhEr.length);p.hEr=zeros([p.xhEr.length,p.xhEr[0].length])}else{p.xhEr=p.yhEr=p.hEr=[[]]}if(nNE_uL>0){p.xuEl=bcast("-",xuL,rev(linspaces(1,nNE_uL)).map(el=>el*twodelx));p.yuEl=repeatv(yuL,p.xuEl.length);p.uEl=zeros([p.xuEl.length,p.xuEl[0].length])}else{p.xuEl=p.yuEl=p.uEl=[[]]}if(nNE_uR>0){p.xuEr=bcast("+",xuR,linspaces(1,nNE_uR).map(el=>el*twodelx));p.yuEr=repeatv(yuR,p.xuEr.length);p.uEr=zeros([p.xuEr.length,p.xuEr[0].length])}else{p.xuEr=p.yuEr=p.uEr=[[]]}if(nNE_vL>0){p.xvEl=bcast("-",xvL,rev(linspaces(1,nNE_vL)).map(el=>el*twodelx));p.yvEl=repeatv(yvL,p.xvEl.length);p.vEl=zeros([p.xvEl.length,p.xvEl[0].length])}else{p.xvEl=p.yvEl=p.vEl=[[]]}if(nNE_vR>0){p.xvEr=bcast("+",xvR,linspaces(1,nNE_vR).map(el=>el*twodelx));p.yvEr=repeatv(yvR,p.xvEr.length);p.vEr=zeros([p.xvEr.length,p.xvEr[0].length])}else{p.xvEr=p.yvEr=p.vEr=[[]]}var xhB=col(p.xxh,0);var xuB=col(p.xxu,0);var xvB=col(p.xxv,0);var yhB=col(p.yyh,0);var yuB=col(p.yyu,0);var yvB=col(p.yyv,0);var xhT=col(p.xxh,-1);var xuT=col(p.xxu,-1);var xvT=col(p.xxv,-1);var yhT=col(p.yyh,-1);var yuT=col(p.yyu,-1);var yvT=col(p.yyv,-1);if(nTE_hBT>0){p.ihS=nTE_hBT+1;iAdd=linspaces(1,nTE_hBT);xhB=reshape(rev(iAdd).map(el=>xhB[0][0]-el*twodelx).concat(xhB.flat(),iAdd.map(el=>xhB[xhB.length-1][0]+el*twodelx)),null,1);yhB=reshape([].concat(yhB[0][0],yhB.flat(),yhB[yhB.length-1][0]),null,1);xhT=reshape(rev(iAdd).map(el=>xhT[0][0]-el*twodelx).concat(xhT.flat(),iAdd.map(el=>xhT[xhT.length-1][0]+el*twodelx)),null,1);yhT=reshape([].concat(yhT[0][0],yhT.flat(),yhT[yhT.length-1][0]),null,1);p.ihE=yhT.length-nTE_hBT}if(nTE_uBT>0){p.iuS=nTE_uBT+1;iAdd=linspaces(1,nTE_uBT);xuB=reshape(rev(iAdd).map(el=>xuB[0][0]-el*twodelx).concat(xuB.flat(),iAdd.map(el=>xuB[xuB.length-1][0]+el*twodelx)),null,1);yuB=reshape([].concat(yuB[0][0],yuB.flat(),yuB[yuB.length-1][0]),null,1);xuT=reshape(rev(iAdd).map(el=>xuT[0][0]-el*twodelx).concat(xuT.flat(),iAdd.map(el=>xuT[xuT.length-1][0]+el*twodelx)),null,1);yuT=reshape([].concat(yuT[0][0],yuT.flat(),yuT[yuT.length-1][0]),null,1);p.iuE=yuT.length-nTE_uBT}if(nTE_vBT>0){p.ivS=nTE_vBT+1;iAdd=linspaces(1,nTE_vBT);xvB=reshape(rev(iAdd).map(el=>xvB[0][0]-el*twodelx).concat(xvB.flat(),iAdd.map(el=>xvB[xvB.length-1][0]+el*twodelx)),null,1);yvB=reshape([].concat(yvB[0][0],yvB.flat(),yvB[yvB.length-1][0]),null,1);xvT=reshape(rev(iAdd).map(el=>xvT[0][0]-el*twodelx).concat(xvT.flat(),iAdd.map(el=>xvT[xvT.length-1][0]+el*twodelx)),null,1);yvT=reshape([].concat(yvT[0][0],yvT.flat(),yvT[yvT.length-1][0]),null,1);p.ivE=yvT.length-nTE_vBT}if(nNE_hB>0){p.yhEb=bcast("-",yhB,[rev(linspaces(1,nNE_hB)).map(el=>el*twodely)]);p.xhEb=repeath(xhB,p.yhEb[0].length);p.hEb=zeros([p.xhEb.length,p.xhEb[0].length])}else{p.xhEb=p.yhEb=p.hEb=[[]]}if(nNE_hT>0){p.yhEt=bcast("+",yhT,[linspaces(1,nNE_hT).map(el=>el*twodely)]);p.xhEt=repeath(xhT,p.yhEt[0].length);p.hEt=zeros([p.xhEt.length,p.xhEt[0].length])}else{p.xhEt=p.yhEt=p.hEt=[[]]}if(nNE_uB>0){p.yuEb=bcast("-",yuB,[rev(linspaces(1,nNE_uB)).map(el=>el*twodely)]);p.xuEb=repeath(xuB,p.yuEb[0].length);p.uEb=zeros([p.xuEb.length,p.xuEb[0].length])}else{p.xuEb=p.yuEb=p.uEb=[[]]}if(nNE_uT>0){p.yuEt=bcast("+",yuT,[linspaces(1,nNE_uT).map(el=>el*twodely)]);p.xuEt=repeath(xuT,p.yuEt[0].length);p.uEt=zeros([p.xuEt.length,p.xuEt[0].length])}else{p.xuEt=p.yuEt=p.uEt=[[]]}if(nNE_vB>0){p.yvEb=bcast("-",yvB,[rev(linspaces(1,nNE_vB)).map(el=>el*twodely)]);p.xvEb=repeath(xvB,p.yvEb[0].length);p.vEb=zeros([p.xvEb.length,p.xvEb[0].length])}else{p.xvEb=p.yvEb=p.vEb=[[]]}if(nNE_vT>0){p.yvEt=bcast("+",yvT,[linspaces(1,nNE_vT).map(el=>el*twodely)]);p.xvEt=repeath(xvT,p.yvEt[0].length);p.vEt=zeros([p.xvEt.length,p.xvEt[0].length])}else{p.xvEt=p.yvEt=p.vEt=[[]]}if(p.sh[0]%2!=0&&p.sh[1]%2!=0){p.centerField="h";p.centerInd=[idiv(p.sh[0]+1,2),idiv(p.sh[1]+1,2)]}else if(p.su[0]%2!=0&&p.su[1]%2!=0){p.centerField="u";p.centerInd=[idiv(p.su[0]+1,2),idiv(p.su[1]+1,2)]}else if(p.sv[0]%2!=0&&p.sv[1]%2!=0){p.centerField="v";p.centerInd=[idiv(p.sv[0]+1,2),idiv(p.sv[1]+1,2)]}else{p.centerField="x";p.centerInd=[-1,-1]}p.nh=prod(p.sh);p.nu=prod(p.su);p.nv=prod(p.sv);p.nI=p.nh+p.nu+p.nv;p.nhEl=prod(size(p.hEl));p.nhEr=prod(size(p.hEr));p.nhEb=prod(size(p.hEb));p.nhEt=prod(size(p.hEb));p.nuEl=prod(size(p.uEl));p.nuEr=prod(size(p.uEr));p.nuEb=prod(size(p.uEb));p.nuEt=prod(size(p.uEb));p.nvEl=prod(size(p.vEl));p.nvEr=prod(size(p.vEr));p.nvEb=prod(size(p.vEb));p.nvEt=prod(size(p.vEb));p.nhE=p.nhEl+p.nhEr+p.nhEb+p.nhEt;p.nuE=p.nuEl+p.nuEr+p.nuEb+p.nuEt;p.nvE=p.nvEl+p.nvEr+p.nvEb+p.nvEt;p.nE=p.nhE+p.nuE+p.nvE;return p}function genPatchGrid(cfg){var pg={};if(!("edgeThickN"in cfg&&"edgeThickT"in cfg)){[cfg["edgeThickN"],cfg["edgeThickT"]]=getPatchEdgeThicks(modelName)}pg.edgeThickN=cfg["edgeThickN"];pg.edgeThickT=cfg["edgeThickT"];pg.gridType=cfg["pGridType"];[pg.patchAR,pg.xSpacing,pg.ySpacing]=cfg["macroSpacing"].split("+");var microGridTypes=pg.gridType.split("+");var microGridPatchTile=[[microGridTypes[0],microGridTypes[2]],[microGridTypes[1],microGridTypes[3]]];pg.Lx=cfg["Lx"];pg.Ly=cfg["Ly"];pg.xPb=gridSpacing(pg.xSpacing,cfg["Nx"],-pg.Lx/2,pg.Lx/2);pg.yPb=gridSpacing(pg.ySpacing,cfg["Ny"],-pg.Ly/2,pg.Ly/2);pg.grid=[];var nP=0;var nI=0;var nE=0;for(let iP=0;iP<cfg.Nx;iP++){let xb=[pg.xPb[iP],pg.xPb[iP+1]];let grid_iP=[];for(let jP=0;jP<cfg.Ny;jP++){let yb=[pg.yPb[jP],pg.yPb[jP+1]];microGridType=microGridPatchTile[iP%2][jP%2];let p=genStagPatch2D(cfg,xb,yb,microGridType);if(p.nI!=0){nP+=1;nI+=p.nI;nE+=p.nE}grid_iP.push(p)}pg.grid.push(grid_iP)}pg.nP=nP;pg.nI=nI;pg.nE=nE;[pg.Nx,pg.Ny]=size(pg.grid);return pg}function get_xy(pg){var xh=[];var yh=[];var xu=[];var yu=[];var xv=[];var yv=[];var xhE=[];var yhE=[];var xuE=[];var yuE=[];var xvE=[];var yvE=[];for(let iP=0;iP<pg.Nx;iP++){for(let jP=0;jP<pg.Ny;jP++){var p=pg.grid[iP][jP];if(p.nI!=0){xh=xh.concat(p.xxh.flat());yh=yh.concat(p.yyh.flat());xu=xu.concat(p.xxu.flat());yu=yu.concat(p.yyu.flat());xv=xv.concat(p.xxv.flat());yv=yv.concat(p.yyv.flat());xhE=xhE.concat(p.xhEl.flat(),p.xhEr.flat(),p.xhEb.flat(),p.xhEt.flat());yhE=yhE.concat(p.yhEl.flat(),p.yhEr.flat(),p.yhEb.flat(),p.yhEt.flat());xuE=xuE.concat(p.xuEl.flat(),p.xuEr.flat(),p.xuEb.flat(),p.xuEt.flat());yuE=yuE.concat(p.yuEl.flat(),p.yuEr.flat(),p.yuEb.flat(),p.yuEt.flat());xvE=xvE.concat(p.xvEl.flat(),p.xvEr.flat(),p.xvEb.flat(),p.xvEt.flat());yvE=yvE.concat(p.yvEl.flat(),p.yvEr.flat(),p.yvEb.flat(),p.yvEt.flat())}}}return[xh,yh,xu,yu,xv,yv,xhE,yhE,xuE,yuE,xvE,yvE]}function genPatchGridPlotData(cfg){pg=genPatchGrid(cfg);[xh,yh,xu,yu,xv,yv,xhE,yhE,xuE,yuE,xvE,yvE]=get_xy(pg);xC=[];yC=[];var N=cfg["Nx"];for(let iP=0;iP<N;iP+=2){for(let jP=0;jP<N;jP+=2){var p=pg.grid[iP][jP];let Dx=p.Dx;let Dy=p.Dy;xC.push(p.xc-.5*Dx);yC.push(p.yc-.5*Dy);xC.push(p.xc+1.5*Dx);yC.push(p.yc-.5*Dy);xC.push(p.xc+1.5*Dx);yC.push(p.yc+1.5*Dy);xC.push(p.xc-.5*Dx);yC.push(p.yc+1.5*Dy);xC.push(p.xc-.5*Dx);yC.push(p.yc-.5*Dy);xC.push(NaN);yC.push(NaN)}}xPb=[];yPb=[];xhC=[];yhC=[];xuC=[];yuC=[];xvC=[];yvC=[];var xG=[];var yG=[];xmuG=[];ymuG=[];xMG=[];yMG=[];for(let iP=0;iP<N;iP++){for(let jP=0;jP<N;jP++){var p=pg.grid[iP][jP];if(jP==0){xG.push(p.xc)}if(iP==0){yG.push(p.yc)}if(p.centerField=="h"){xhC.push(p.xc);yhC.push(p.yc)}else if(p.centerField=="u"){xuC.push(p.xc);yuC.push(p.yc)}else if(p.centerField=="v"){xvC.push(p.xc);yvC.push(p.yc)}if(p.nI!=0){xPb.push(p.xc-.5*p.lx);yPb.push(p.yc-.5*p.ly);xPb.push(p.xc+.5*p.lx);yPb.push(p.yc-.5*p.ly);xPb.push(p.xc+.5*p.lx);yPb.push(p.yc+.5*p.ly);xPb.push(p.xc-.5*p.lx);yPb.push(p.yc+.5*p.ly);xPb.push(p.xc-.5*p.lx);yPb.push(p.yc-.5*p.ly);xPb.push(NaN);yPb.push(NaN);let xg=col(p.xxg,0).flat();let xgLim=[xg[0],xg[xg.length-1]];let yg=p.yyg[0].flat();let ygLim=[yg[0],yg[yg.length-1]];for(let i=0;i<xg.length;i++){xmuG=xmuG.concat([xg[i],xg[i],NaN]);ymuG=ymuG.concat([ygLim[0],ygLim[1],NaN])}for(let i=0;i<yg.length;i++){ymuG=ymuG.concat([yg[i],yg[i],NaN]);xmuG=xmuG.concat([xgLim[0],xgLim[1],NaN])}}}}nhC=xhC.length;nuC=xuC.length;nvC=xvC.length;if(nhC==0){xhC=[-1e3];yhC=[-1e3]}if(nuC==0){xuC=[-1e3];yuC=[-1e3]}if(nvC==0){xvC=[-1e3];yvC=[-1e3]}var huvStr="huv";pCentred=true;for(let iP=0;iP<2;iP++){for(let jP=0;jP<2;jP++){var p=pg.grid[iP][jP];pCentred&=huvStr.includes(p.centerField)||p.nI==0}}var symPatches=["uuvv","hhvv","uuhh","hhhh","xxxx"];pSymmetric=pg.gridType.split("+").filter(el=>!symPatches.includes(el)).length==0;let xGLim=[-pg.Lx/2,pg.Lx/2];let yGLim=[-pg.Ly/2,pg.Ly/2];for(let i=0;i<xG.length;i++){xMG=xMG.concat([xG[i],xG[i],NaN]);yMG=yMG.concat([yGLim[0],yGLim[1],NaN])}for(let i=0;i<yG.length;i++){yMG=yMG.concat([yG[i],yG[i],NaN]);xMG=xMG.concat([xGLim[0],xGLim[1],NaN])}xData=[xMG,xmuG,xC,xPb,xh,xu,xv,xhE,xuE,xvE,xhC,xuC,xvC];yData=[yMG,ymuG,yC,yPb,yh,yu,yv,yhE,yuE,yvE,yhC,yuC,yvC];traceNames=["Patch macro-grid","Sub-patch micro-grid","Macro-cell boundary","Patch boundary","h interior nodes ("+xh.length+")","u interior nodes ("+xu.length+")","v interior nodes ("+xv.length+")","h edge nodes ("+xhE.length+")","u edge nodes ("+xuE.length+")","v edge nodes ("+xvE.length+")","h centre nodes ("+nhC+")","u centre nodes ("+nuC+")","v centre nodes ("+nvC+")"]}domainScale=1;N=6;n=6;r=.1;idNum=79985;cfg={Nx:N,Ny:N,nx:n,ny:n,rx:r,ry:r};cfg["Lx"]=cfg["Ly"]=domainScale*2*Math.PI;cfg["macroSpacing"]="sq+lr+lr";cfg["pGridType"]=idToPGridType(idNum);cfg["Mx"]=idiv(cfg["Nx"],2);cfg["My"]=idiv(cfg["Ny"],2);modelName="gLnrWve";[cfg["edgeThickN"],cfg["edgeThickT"]]=getPatchEdgeThicks(modelName);maxEdgeThick=Math.max(cfg["edgeThickN"],cfg["edgeThickT"]);maxm=Math.max(cfg["nx"],cfg["ny"])/2;if(maxEdgeThick==0){cfg["rx"]=cfg["ry"]=.4}else if(maxEdgeThick==1){cfg["rx"]=cfg["ry"]=.375}else if(maxEdgeThick==2){cfg["rx"]=cfg["ry"]=.3;if(maxm==4){cfg["rx"]=cfg["ry"]=.35}else if(maxm==6){cfg["rx"]=cfg["ry"]=.375}else if(maxm==8){cfg["rx"]=cfg["ry"]=.4}}else if(maxEdgeThick==3){cfg["rx"]=cfg["ry"]=.25;if(maxm==4){cfg["rx"]=cfg["ry"]=.3}else if(maxm==6){cfg["rx"]=cfg["ry"]=.35}else if(maxm==8){cfg["rx"]=cfg["ry"]=.375}}else if(maxEdgeThick==4){cfg["rx"]=cfg["ry"]=.2}po={};po["subPatchGridAlpha"]=.3;po["msInteriorNode"]=1.9;po["msBoundaryNode"]=1.1*po["msInteriorNode"];po["patchWrapAlpha"]=.1;po["patchBoundaryLw"]=1;po["cellBoundaryLw"]=.5;po["tinyMargin"]=.005;po["mewBoundaryNode"]=.6;po["boundaryMargin"]=.003;po["plotVariant"]="huvNodes";po["oMode"]="custom";po["wantAnnotations"]=true;po["wantAnnotations"]=false;po["iA_l"]=cfg["Mx"]-1;po["iA_Delta"]=cfg["Mx"];po["jA_delta"]=cfg["My"]-1;po["wantCellBoundaries"]=true;po["wantGridLinesOnPathcCell"]=true;po["wantLegend"]=true;po["wantLegend"]=false;po["scaledSpace"]=false;po["scaledSpace"]=true;po["infMargin"]=1.04;po["infMargin"]=1.8;po["wantWavyBounds"]=true;po["listSymb"]=true;po["wantNodes"]=false;po["wantNodes"]=true;po["tickIndMode"]="leftOriginIJ";po["tickIndMode"]="xy";if(modelName!="idlWve"){po["infMargin"]=1.04;cfg["rx"]=cfg["ry"]=.25}genPatchGridPlotData(cfg);function updateOutPrms(){document.getElementById("npI_spn").textContent=pg.nI;document.getElementById("npE_spn").textContent=pg.nE;if(pSymmetric){var el=document.getElementById("pSymmetric");el.innerHTML="Symmetric";el.style.color="green";var el=document.getElementById("pStable");el.innerHTML="Stable";el.style.color="green"}else{var el=document.getElementById("pSymmetric");el.innerHTML="Asymmetric";el.style.color="red";var el=document.getElementById("pStable");el.innerHTML="Unstable";el.style.color="red"}if(pCentred){var el=document.getElementById("pCentred");el.innerHTML="Centred";el.style.color="green";var el=document.getElementById("pAccurate");el.innerHTML="Accurate";el.style.color="green"}else{var el=document.getElementById("pCentred");el.innerHTML="Non-centred";el.style.color="red";var el=document.getElementById("pAccurate");el.innerHTML="Inaccurate";el.style.color="red"}}updateOutPrms();cfg.pGridType=document.getElementById("pType_txt").value=idToPGridType(idNum);var clrg="DarkGreen";var clrpb="rgba(148, 0, 211, 0.5)";var clrcb="rgba(255, 68, 0, 0.3)";var clrh="#000000";var clru="#ff0000";var clrv="#1160ff";MG={name:"Patch macro-grid",x:xMG,y:yMG,mode:"lines",type:"scatter",hoverinfo:"none",line:{width:.5,color:clrpb},showlegend:true};muG={name:"Sub-patch micro-grid",x:xmuG,y:ymuG,mode:"lines",type:"scatter",hoverinfo:"none",line:{width:.6,color:clrg},showlegend:true};cB={name:"Macro-cell boundary",x:xC,y:yC,mode:"lines",type:"scatter",hoverinfo:"none",line:{width:1.5,color:clrcb},showlegend:true};pB={name:"Patch boundary",x:xPb,y:yPb,mode:"lines",type:"scatter",hoverinfo:"none",line:{width:2.25,color:clrpb},showlegend:true};sf=2.8;msI=1.1*sf*po["msInteriorNode"];msE=.9*sf*po["msBoundaryNode"];msC=1.5*sf*po["msInteriorNode"];hI={name:"h interior nodes ("+xh.length+")  ",x:xh,y:yh,mode:"markers",type:"scatter",marker:{opacity:.9,size:msI,color:clrh},hoverinfo:"none",showlegend:true};uI={name:"u interior nodes ("+xu.length+")",x:xu,y:yu,mode:"markers",type:"scatter",marker:{opacity:.9,size:msI,color:clru},hoverinfo:"none",showlegend:true};vI={name:"v interior nodes ("+xv.length+")",x:xv,y:yv,mode:"markers",type:"scatter",marker:{opacity:.9,size:msI,color:clrv},hoverinfo:"none",showlegend:true};hE={name:"h edge nodes ("+xhE.length+")",x:xhE,y:yhE,mode:"markers",type:"scatter",marker:{opacity:.9,size:msE,color:"#ffffff",line:{width:1.2,color:clrh}},hoverinfo:"none",showlegend:true};uE={name:"u edge nodes ("+xuE.length+")",x:xuE,y:yuE,mode:"markers",type:"scatter",marker:{opacity:.9,size:msE,color:"#ffffff",line:{width:1.2,color:clru}},hoverinfo:"none",showlegend:true};vE={name:"v edge nodes ("+xvE.length+")",x:xvE,y:yvE,mode:"markers",type:"scatter",marker:{opacity:.9,size:msE,color:"#ffffff",line:{width:1.2,color:clrv}},hoverinfo:"none",showlegend:true};hC={name:"h centre nodes ("+nhC+")",x:xhC,y:yhC,mode:"markers",type:"scatter",marker:{opacity:.9,size:msC,color:clrh},hoverinfo:"none",showlegend:true};uC={name:"u centre nodes ("+nuC+")",x:xuC,y:yuC,mode:"markers",type:"scatter",marker:{opacity:.9,size:msC,color:clru},hoverinfo:"none",showlegend:true};vC={name:"v centre nodes ("+nvC+")",x:xvC,y:yvC,mode:"markers",type:"scatter",marker:{opacity:.9,size:msC,color:clrv},hoverinfo:"none",showlegend:true};data=[MG,muG,cB,pB,hI,uI,vI,hE,uE,vE,hC,uC,vC];var layout={autosize:false,width:900,height:700,margin:{autoexpand:false,pad:0,l:9,r:190,b:25,t:8},xaxis:{scaleanchor:"y",anchor:"free",position:.05,title:{text:"$x$"},zeroline:false,tickvals:[],showticklabels:false,range:[-Math.PI-.02,Math.PI+.02],titlefont:{size:20}},yaxis:{anchor:"free",position:.07,automargin:false,title:{text:"$y$"},zeroline:false,tickvals:[],showticklabels:false,range:[-Math.PI-.02,Math.PI+.02],titlefont:{size:20}},legend:{x:1,automargin:true,visible:true,font:{family:"Palatino, Computer Modern Serif, Serif",size:15}}};var config={responsive:true,displayModeBar:false};Plotly.newPlot("plotDiv",data,layout,config);function get_pIdSlidetTicks(n){if(n/2%2!=0){var cPgTypes=centredPGridTypes_oddn2}else{var cPgTypes=centredPGridTypes_evenn2}var tickStr="";for(let i=0;i<cPgTypes.length;i++){let st=cPgTypes[i];tickStr+=`<option value="${st}" label="${st}" class="slidertick"></option>\n`}return tickStr}document.getElementById("stableIdTicks").innerHTML=get_pIdSlidetTicks(document.getElementById("n_nmbr").valueAsNumber);function updatePlot(traceInds){var uNames=[];var uX=[];var uY=[];for(let j=0;j<traceInds.length;j+=1){i=traceInds[j];uNames.push(traceNames[i]);uX.push(xData[i]);uY.push(yData[i])}var updateData={name:uNames,x:uX,y:uY};Plotly.update("plotDiv",updateData,{},traceInds)}function updatePlotAll(){var updateData={name:traceNames,x:xData,y:yData};Plotly.update("plotDiv",updateData,{},[0,1,2,3,4,5,6,7,8,9,10,11,12])}function on_pId_sldr(){if(document.getElementById("onlyCentred").checked){var idNumOld=document.getElementById("pId_sldr").valueAsNumber;if(cfg.nx/2%2!=0){var cPgTypes=centredPGridTypes_oddn2}else{var cPgTypes=centredPGridTypes_evenn2}var idInd=findClosest(cPgTypes,idNumOld);var idNum=cPgTypes[idInd];document.getElementById("pId_sldr").value=idNum}else{idNum=document.getElementById("pId_sldr").valueAsNumber}document.getElementById("pId_nmbr").value=idNum;cfg.pGridType=document.getElementById("pType_txt").value=idToPGridType(idNum);genPatchGridPlotData(cfg);updateOutPrms();var traceInds=[1,3,4,5,6,7,8,9,10,11,12];updatePlot(traceInds)}document.getElementById("pId_sldr").addEventListener("input",on_pId_sldr,false);pId_nmbrPrev=document.getElementById("pId_nmbr").valueAsNumber;function on_pId_nmbr(){var idNumOld=document.getElementById("pId_nmbr").valueAsNumber;if(document.getElementById("onlyCentred").checked){if(cfg.nx/2%2!=0){var cPgTypes=centredPGridTypes_oddn2}else{var cPgTypes=centredPGridTypes_evenn2}if(idNumOld-pId_nmbrPrev>0){var idInd=findClosest(cPgTypes,idNumOld,"U");if(idInd==undefined){idInd=59}}else{var idInd=findClosest(cPgTypes,idNumOld,"L");if(idInd==undefined){idInd=0}}var idNum=cPgTypes[idInd];document.getElementById("pId_nmbr").value=idNum}else{idNum=document.getElementById("pId_nmbr").valueAsNumber}document.getElementById("pId_sldr").value=idNum;cfg.pGridType=document.getElementById("pType_txt").value=idToPGridType(idNum);genPatchGridPlotData(cfg);updateOutPrms();var traceInds=[1,3,4,5,6,7,8,9,10,11,12];updatePlot(traceInds);pId_nmbrPrev=document.getElementById("pId_nmbr").value}document.getElementById("pId_nmbr").addEventListener("input",on_pId_nmbr,false);document.getElementById("pType_txt").addEventListener("input",function(){var pGridType=this.value;var idNum=pGridTypeToId(pGridType);if(idNum==-1){return}document.getElementById("pId_sldr").value=document.getElementById("pId_nmbr").value=idNum;cfg.pGridType=pGridType;genPatchGridPlotData(cfg);updateOutPrms();var traceInds=[1,3,4,5,6,7,8,9,10,11,12];updatePlot(traceInds)},false);document.getElementById("pType_txt").addEventListener("focusout",function(){var pGridType=this.value;var idNum=pGridTypeToId(pGridType);if(idNum==-1){document.getElementById("pType_txt").value=cfg.pGridType}},false);document.getElementById("N_nmbr").addEventListener("input",function(){cfg.Nx=cfg.Ny=this.valueAsNumber;genPatchGridPlotData(cfg);document.getElementById("npI_spn").textContent=pg.nI;document.getElementById("npE_spn").textContent=pg.nE;if(cfg.Nx==6){sf=2.8}else if(cfg.Nx==4){sf=3.15}else if(cfg.Nx==2){sf=4.2}msI=1.1*sf*po["msInteriorNode"];msE=.9*sf*po["msBoundaryNode"];msC=1.5*sf*po["msInteriorNode"];hI.marker.size=uI.marker.size=vI.marker.size=msI;hE.marker.size=uE.marker.size=vE.marker.size=msE;hC.marker.size=uC.marker.size=vC.marker.size=msC;updatePlotAll()},false);document.getElementById("n_nmbr").addEventListener("input",function(){cfg.nx=cfg.ny=this.valueAsNumber;document.getElementById("stableIdTicks").innerHTML=get_pIdSlidetTicks(cfg.nx);genPatchGridPlotData(cfg);updateOutPrms();var traceInds=[1,4,5,6,7,8,9,10,11,12];updatePlot(traceInds)},false);document.getElementById("eTN_nmbr").addEventListener("input",function(){cfg.edgeThickN=this.valueAsNumber;genPatchGridPlotData(cfg);document.getElementById("npE_spn").textContent=pg.nE;var traceInds=[7,8,9];updatePlot(traceInds)},false);document.getElementById("eTT_nmbr").addEventListener("input",function(){cfg.edgeThickT=this.valueAsNumber;genPatchGridPlotData(cfg);document.getElementById("npE_spn").textContent=pg.nE;var traceInds=[7,8,9];updatePlot(traceInds)},false);document.getElementById("r_sldr").addEventListener("input",function(){var r=this.value/100;document.getElementById("r_txt").innerHTML=r;cfg.rx=cfg.ry=r;genPatchGridPlotData(cfg);var traceInds=[1,3,4,5,6,7,8,9];updatePlot(traceInds)},false);document.getElementById("onlyCentred").addEventListener("input",function(){if(this.checked){document.getElementById("pType_txt").disabled=true;document.getElementById("n_nmbr").disabled=true}else{document.getElementById("pType_txt").disabled=false;document.getElementById("n_nmbr").disabled=false}on_pId_sldr()},false);